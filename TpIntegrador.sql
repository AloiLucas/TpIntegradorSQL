/*--------------------------------------------------*/
/* Creamos las tablas */
/*--------------------------------------------------*/


CREATE TABLE OFICINAS(
	OFICINA INTEGER NOT NULL,
	CIUDAD VARCHAR(15) NOT NULL,
	REGION VARCHAR(10) NOT NULL,
	DIR INTEGER,
	OBJETIVO FLOAT,
	VENTAS FLOAT NOT NULL,
	PRIMARY KEY (OFICINA));


CREATE TABLE REPVENTAS(
	NUM_EMPL INTEGER NOT NULL,
	NOMBRE VARCHAR(15) NOT NULL,
	EDAD INTEGER,
	OFICINA_REP INTEGER,
	TITULO VARCHAR(10),
	CONTRATO DATE NOT NULL,
	DIRECTOR INTEGER,
	CUOTA FLOAT,
	VENTAS FLOAT NOT NULL,
	PRIMARY KEY(NUM_EMPL));


CREATE TABLE CLIENTES(
	NUM_CLIE INTEGER NOT NULL,
	EMPRESA VARCHAR(20) NOT NULL,
	REP_CLIE INTEGER,
	LIMITE_CREDITO FLOAT,
	PRIMARY KEY(NUM_CLIE));
	
	
CREATE TABLE PRODUCTOS(
	ID_FAB CHAR(3) NOT NULL,
	ID_PRODUCTO CHAR(5) NOT NULL,
	DESCRIPCION VARCHAR(20) NOT NULL,
	PRECIO FLOAT NOT NULL,
	EXISTENCIAS INTEGER NOT NULL,
	PRIMARY KEY(ID_FAB, ID_PRODUCTO));
	

CREATE TABLE PEDIDOS(
	NUM_PEDIDO INTEGER NOT NULL AUTO_INCREMENT,
	FECHA_PEDIDO DATE NOT NULL,
	CLIE INTEGER NOT NULL,
	REP INTEGER,
	FAB CHAR(3) NOT NULL,
	PRODUCTO CHAR(5) NOT NULL,
	CANT INTEGER NOT NULL,
	IMPORTE FLOAT NOT NULL,
	PRIMARY KEY(NUM_PEDIDO));

/*--------------------------------------------------*/
/*Agregamos las Foreign Key*/
/*--------------------------------------------------*/

/* Tabla REPVENTAS */
	
ALTER TABLE repventas ADD CONSTRAINT OPERAEN FOREIGN KEY (OFICINA_REP)
REFERENCES OFICINAS (OFICINA) ON DELETE SET NULL;

ALTER TABLE repventas ADD CONSTRAINT/*AGREGA RESTRICCION*/ DIRECTOR /*NOMBRE DESCRITIVO DE LA TABLA*/ FOREIGN KEY (DIRECTOR)/*QUE VARIABLE QUIEREO Q SEA FOREIGN KEY*/
REFERENCES repventas (NUM_EMPL) ON DELETE CASCADE; /*ACA VA DE QUE RTABLA Y VARIABLE VIENE*/


/* Tabla OFICINAS */

ALTER TABLE OFICINAS ADD CONSTRAINT HAYDIR FOREIGN KEY (DIR)
REFERENCES REPVENTAS (NUM_EMPL) ON DELETE CASCADE;


/* Tabla CLIENTES */
	
ALTER TABLE CLIENTES ADD CONSTRAINT HAYREP FOREIGN KEY (REP_CLIE)
REFERENCES REPVENTAS (NUM_EMPL) ON DELETE CASCADE;



/* Tabla PEDIDOS */

ALTER TABLE PEDIDOS ADD CONSTRAINT PEDIDOPOR FOREIGN KEY (CLIE)
REFERENCES CLIENTES (NUM_CLIE) ON DELETE CASCADE;
	

ALTER TABLE PEDIDOS ADD CONSTRAINT TOMADOPOR FOREIGN KEY (REP)
REFERENCES REPVENTAS (NUM_EMPL) ON DELETE CASCADE;

	
ALTER TABLE PEDIDOS ADD CONSTRAINT ESPOR FOREIGN KEY (FAB, PRODUCTO)
REFERENCES productos (ID_FAB, ID_PRODUCTO) ON DELETE CASCADE;
	
	
	

/*--------------------------------------------------*/
/* Llenamos las tablas */
/*--------------------------------------------------*/


/* Tabla PRODUCTOS */
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("REI", "2A45C", "V Stago Trinquete", 79, 210);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ASI", "4100Y", "Extractor", 2750, 25);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("QSA", "XK47", "Reductor", 355, 38);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("BIC", "41672", "Reductor", 180, 0);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "779C", "Riostra 2-Tm", 1875, 9);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ACI", "41003", "Articulo tipo 3", 107, 207);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ACI", "41004", "Articulo tipo 4", 117, 139);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("BIC", "41003", "Manivela", 652, 3);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "887P", "Perno Riostra", 250, 24);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("QSA", "XK48", "Reductor", 134, 203);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("REI", "2A44L", "Bisagra Izqda.", 4500, 12);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("FEA", "112", "Cubierta", 148, 115);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "887H", "Soporte Riostra", 54, 223);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("BIC", "41089", "Retn", 225, 78);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ASI", "41001", "Articulo tipo 1", 55, 277);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "775C", "Riostra 1-Tm", 1425, 5);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ACI", "4100Z", "Montador", 2500, 28);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("QSA", "XK48A", "Reductor", 117, 37);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ACI", "41002", "Articulo tipo 2", 76, 167);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("REI", "2A44R", "Bisagra Dcha.", 4500, 12);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "773C", "Riostra 1/2-Tm", 975, 28);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("ACI", "4100X", "Ajustador", 25, 37);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("FEA", "114", "Bancada Motor", 243, 15);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("IMM", "887X", "Reenedor Riostra", 475, 32);
INSERT INTO PRODUCTOS(ID_FAB, ID_PRODUCTO, DESCRIPCION, PRECIO, EXISTENCIAS) VALUES ("REI", "2A44G", "Pasador Bisagra", 350, 14);

/* Tabla OFICINAS */
INSERT INTO OFICINAS(OFICINA, CIUDAD, REGION, DIR, OBJETIVO, VENTAS) VALUES (22, "Denver", "Oeste", 108, 300000.00,186042.00);
INSERT INTO OFICINAS(OFICINA, CIUDAD, REGION, DIR, OBJETIVO, VENTAS) VALUES (11, "New York", "Este", 106, 575000.00,692637.00);
INSERT INTO OFICINAS(OFICINA, CIUDAD, REGION, DIR, OBJETIVO, VENTAS) VALUES (12, "Chicago", "Este", 104, 800000.00,735042.00);
INSERT INTO OFICINAS(OFICINA, CIUDAD, REGION, DIR, OBJETIVO, VENTAS) VALUES (13, "Alanta", "Este", 105, 350000.00,367911.00);
INSERT INTO OFICINAS(OFICINA, CIUDAD, REGION, DIR, OBJETIVO, VENTAS) VALUES (21, "Los Angeles", "Oeste", 108, 725000.00,835915.00);


/* Tabla PEDIDOS */
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-12-17",2117,106,"REI","2A44L", 7, 31500);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-11",2111,107,"ACI","41003", 35, 3745);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-03",2101,106,"FEA","114", 6, 1458);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-10",2118,108,"QSA","XK47", 4, 1420);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-10-12",2102,101,"ACI","41004", 34, 3978);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-30",2107,110,"ACI","4100Z", 9, 22500);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-02",2112,108,"REI","2A44R", 10, 45000);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-12-17",2103,105,"ACI","41004", 28, 3276);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-14",2118,108,"BIC","41003", 1, 652);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-23",2108,109,"FEA","112", 10, 1480);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-08",2124,107,"BIC","41003", 1, 652);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-12-17",2103,105,"ACI","41004", 6, 702);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-20",2114,108,"QSA","XK47", 20, 7100);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-24",2124,107,"FEA","114", 10, 2430);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-10-12",2114,102,"ACI","4100Z", 6, 15000);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-22",2103,105,"ACI","41002", 54, 4104);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-08",2112,108,"IMM","773C", 3, 2925);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-03-02",2109,107,"IMM","775C", 22, 31350);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-29",2107,110,"REI","2A45C", 8, 632);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-11-04",2118,108,"ACI","41002", 10, 760);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-10-12",2111,103,"REI","2A44G", 6, 2100);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1998-02-15",2108,101,"ACI","4100X", 6, 150);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-10",2120,102,"IMM","779C", 2, 3750);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-01-04",2106,102,"REI","2A45C", 24, 1896);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-27",2106,102,"QSA","XK47", 6, 2130);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-01-25",2108,109, "IMM","779C", 3, 5625);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-10",2118,108, "QSA","XK47", 2, 776);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1989-12-31",2103,105, "ACI","4100Y", 11, 27500);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-18",2111,103, "ACI","4100X", 24, 600);
INSERT INTO pedidos(FECHA_PEDIDO, CLIE, REP, FAB, PRODUCTO, CANT, IMPORTE) VALUES ("1990-02-02",2113,101,"REI","2A44R", 5, 22500);



/* Tabla CLIENTES */
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2111, "JCP Inc.", 103, 50000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2102, "First Corp.", 101, 65000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2103, "Acme Mfg.", 105, 50000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2123, "Carter & Sons", 102, 40000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2107, "Ace International", 110, 35000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2115, "Smithson Corp.", 101, 20000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2101, "Jones Mfg.", 106, 65000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2112, "Zetacorp", 108, 50000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2121, "QMA Assoc.", 103, 45000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2114, "Orrion Corp.", 102, 20000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2124, "Peter Brhothers", 107, 40000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2108, "Holm & Landis", 109, 55000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2117, "J.P.Sinclair", 106, 35000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2122, "Three-Way Lines", 105, 30000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2120, "Rico Enterprises", 102, 50000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2106, "Fred Lewis Corp", 102, 65000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2119, "Solomon Inc.", 109, 25000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2118, "Midwest Systems", 108, 60000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2113, "Ian & Schmith", 104, 20000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2109, "Chen Associates", 103, 25000.00);
INSERT INTO clientes (NUM_CLIE, EMPRESA, REP_CLIE, LIMITE_CREDITO) VALUES (2105, "AAA Investments", 101, 45000.00);



/* Tabla REPVENTAS */
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (105, "Bill Adams", 37, 13, "Rep ventas", "1988-02-12", 104, 350000.00,367911.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (109, "Mary Jones", 31, 11, "Rep ventas", "1999-10-12", 106, 300000.00,392725.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (102, "Sue Smith", 48, 21, "Rep ventas", "1986-12-10", 108, 350000.00,474050.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (106, "Sam Clark", 52, 11, "VP ventas", "1988-06-14", 105, 275000.00,299912.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (104, "Bob Smith", 33, 12, "Dir ventas", "1987-05-19", 106, 200000.00,142594.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (101, "DAN Roberts", 45, 12, "Rep ventas", "1986-10-20", 104, 300000.00,305673.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (110, "Tom Snyder", 41, 0, "Rep ventas", "1990-01-13", 105, 0.0,75985.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (108, "Larry Fitch", 62, 21, "Dir ventas", "1989-10-12", 106, 350000.00,361865.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (103, "Paul Cruz", 29, 12, "Rep ventas", "1987-03-01", 104, 275000.00,286775.00);
INSERT INTO repventas (NUM_EMPL, NOMBRE, EDAD, OFICINA_REP, TITULO, CONTRATO, DIRECTOR, CUOTA, VENTAS) VALUES (107, "Nancy Angelli", 49, 22, "Rep ventas", "1988-11-14", 108, 300000.00,186042.00);


/* 1) Lista de las Oficinas de venta de la región Este con sus objetivos y ventas */

SELECT OFICINA, OBJETIVO, VENTAS 
FROM oficinas 
WHERE	REGION = "Este";

/* 2) Lista de las Oficinas (con sus objetivos y ventas) de venta de la región Este, cuyas ventas exeden a sus objetivos, ordenadas en orden alfabético por ciudad */

SELECT OFICINA, OBJETIVO, VENTAS
FROM oficinas
WHERE REGION = "Este"
AND OBJETIVO<VENTAS
ORDER BY CIUDAD;

/* 3) ¿Cuales son los objetivos y ventas promedio para las oficinas de la región Este? */

SELECT AVG(OBJETIVO) AS promedio_Objetivos, AVG (VENTAS) AS promedio_Ventas
FROM oficinas 
WHERE REGION = "Este";

/* 4) ¿Cual es el nombre, cuota y ventas del empleado número 107? */

SELECT NOMBRE, CUOTA, VENTAS
FROM repventas
WHERE NUM_EMPL = 107;

/* 5) Lista de la ciudad, la region y el importe por encima o por debajo del objetivo para cada oficina */

SELECT CIUDAD, REGION, VENTAS-OBJETIVO AS IMPORTE_DIFERENCIA
FROM OFICINAS;


/* 6) Mostrar el valor de inventario para cada producto */

SELECT *, PRECIO * EXISTENCIAS AS VALOR_INVENTARIO
FROM productos;

/* 7) Hallar los vendedores contratados antes de 1988 */

SELECT *
FROM repventas
WHERE CONTRATO < "1988-01-01";

/* 8) Lista de las oficinas cuyas ventas están por debajo del 80% del objetivo */

SELECT *
FROM oficinas
WHERE VENTAS < (0.8 * OBJETIVO);

/* 9) Lista de los pedidos comprendidos entre 01 de Octubre de 1989 y el 31 de Diciembre de 1989 */

SELECT *
FROM pedidos
WHERE (FECHA_PEDIDO > "1989-10-01" && FECHA_PEDIDO < "1989-12-31"); 

/* 10) Hallar todos los pedidos obtenidos por cuatro vendedores específicos (107,109,101,103) */

SELECT *
FROM pedidos
WHERE REP IN (101,103,107,109);



	
